<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns#">
    <head>
        <meta charset="utf-8" />
        <meta name="referrer" content="no-referrer">

        <!-- Enable responsiveness on mobile devices-->
        <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" /> -->
        <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />

        <title>Gisli | Readme</title>

        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-W95TH5W');</script>
        <!-- End Google Tag Manager -->

        <meta property="og:url" content="https://gisli.hamstur.is/README/" />
        <meta property="og:site_name" content="Gísli | Readme" />
        <meta property="og:title" content="Gísli | Readme" />
        <meta property="og:description" content="My thoughts on blockchains and software" />
        <meta name="description" content="My thoughts on blockchains and software" />
        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@gislik" />
        

        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="../css/base.css" />
        <link rel="stylesheet" href="../css/custom.css" />
        <link rel="stylesheet" href="../css/syntax/kate.css" />
        <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro&family=Rock+Salt&display=swap" rel="stylesheet">
        <link href="../css/fontawesome/fontawesome.css" rel="stylesheet">
        <link href="../css/fontawesome/brands.css" rel="stylesheet">
        <link href="../css/fontawesome/solid.css" rel="stylesheet">

        <link rel="icon" type="image/x-icon" href="../icon48x48.png" />
        <link rel="apple-touch-icon" sizes="48x48" href="../icon48x48.png" />
        <link rel="apple-touch-icon" sizes="72x72" href="../icon72x72.png" />
        <link rel="apple-touch-icon" sizes="96x96" href="../icon96x96.png" />
        <link rel="apple-touch-icon" sizes="144x144" href="../icon144x144.png" />
        <link rel="apple-touch-icon" sizes="192x192" href="../icon192x192.png" />
        <!-- <link rel="apple-touch-icon" sizes="256x256" href="" /> -->
        <!-- <link rel="apple-touch-icon" sizes="384x384" href="" /> -->
        <!-- <link rel="apple-touch-icon" sizes="512x512" href="" /> -->

        <link rel="alternate" type="application/atom+xml" title="Readme" href="../atom.xml">
    </head>
    <body>
        <!-- Google Tag Manager (noscript) -->
        <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W95TH5W" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
        <!-- End Google Tag Manager (noscript) -->
        <a href="#main" class="skip-link p-screen-reader-text">Skip to content</a>
        <header class="profile">
            <a class="profile-icon" href="../">
                <img src="../icon72x72.png" alt="profile picture">
            </a>
            <nav class="header">
                <a href="../about/">About</a>
                <a href="../decks/">Decks</a>
            </nav>
        </header>

        <main id="main" class="l-main">
        <article class="p-article">

    <header>
        <h2 class="c-title c-article__title">Readme</h2>
    </header>

    <section id="js-article" class="c-article__body">
        <h1 id="gisli.hamstur.is">gisli.hamstur.is</h1>
<p>In this repo you will find the source code for my personal <a href="https://gisli.hamstur.is">blog</a> where I write about <strong>crypto</strong> and <strong>code</strong>. The website is compiled from <a href="https://daringfireball.net/projects/markdown/">Markdown</a> files using <a href="https://jaspervdj.be/hakyll/">Hakyll</a>. Hakyll allows you to compose a compiler using a DSL which specifies the rules which transform the inputs to the final output. The source code for my compiler is <a href="blog.hs">here</a>.</p>
<h2 id="dependencies">Dependencies</h2>
<p>The project depends on:</p>
<ul>
<li><p>The <a href="https://www.stackage.org/">stackage</a> build system</p>
<p>Please see the chapter <a href="https://docs.haskellstack.org/en/stable/README/#how-to-install">How to install</a> in the official documentation for stack. On macOS I find it easisest to use <a href="https://brew.sh/">Homebrew</a> with <code>brew install haskell-stack</code>.</p></li>
<li><p>The <a href="https://sass-lang.com/install">sass</a> SCSS compiler</p>
<p>Install using either Node.js or Homebrew.</p>
<ul>
<li><code>npm install -g sass</code> (using Node.js)</li>
<li><code>brew install sass/sass/sass</code> (using Homebrew)</li>
</ul></li>
</ul>
<h2 id="building">Building</h2>
<pre><code>$ stack build</code></pre>
<p>Stack will pull in all the dependencies specified in the <a href="blog.cabal">cabal</a> file, the correct version of `ghc, and build the compiler.</p>
<h2 id="writing-content">Writing content</h2>
<p>Pages and blogs are written in static Markdown like the <a href="about.md">About</a> page. Metadata can be placed in the front matter formatted as <a href="https://yaml.org/">YAML</a>. The metadata can be made available both to the compiler and to the template. Page titles are either set explicity in the front matter or derived from the file name.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> This is the blog title</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="an">tags:</span><span class="co"> tag1, tag2</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> /img/image.png</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="an">summary:</span><span class="co"> |</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">  Introduction to the blog content</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>This is the blog body</span></code></pre></div>
<p>Pages in the <code>blog</code> directory are considered to be blog posts which have additional features like pagination, categories and tags. Blog posts are ordered newest to oldest and each post’s date is extracted from the <code>date</code> field, the <code>published</code> field or from the a prefix of the filename. Tags are generated from the <code>tags</code> field in the metadata but categories are derived from the parent folder’s name. When an <code>image</code> is specified it is used in Twitter summary cards.</p>
<p>Summary is either set explicitly in the front matter, read from the content and upto the <code>&lt;!--more--&gt;</code> comment or derived from the first sentence. Summaryr set in the front matter is used as the description for Twitter summary cards.</p>
<p>Some parts of the site are generated without an existing source using Hakyll combinators like the index page which lists a few of the latest blog.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>create [<span class="st">&quot;index.html&quot;</span>] <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    route   <span class="op">$</span> idRoute</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    compile <span class="op">$</span> makeItem <span class="st">&quot;&quot;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>      <span class="op">&gt;&gt;=</span> loadAndApplyTemplate <span class="st">&quot;templates/blog-list.html&quot;</span> (blogCtx <span class="dv">1</span> pages categories tags)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>      <span class="op">&gt;&gt;=</span> loadAndApplyTemplate <span class="st">&quot;templates/default.html&quot;</span> defaultCtx </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>      <span class="op">&gt;&gt;=</span> indexCompiler</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>      <span class="op">&gt;&gt;=</span> relativizeUrls</span></code></pre></div>
<h3 id="generating-table-of-contents">Generating table of contents</h3>
For longer blog posts or pages it can be very convenient to include a table of contains. This is simply achieved by defining the <code>withtoc</code> field in the metadata. The compiler now uses <code>&lt;h1&gt;&lt;/h1&gt;</code> and `
<h2>
</h2>
<p>’ tags as the table entries.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> This is a long blog post</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="an">withtoc:</span><span class="co"> true</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span></code></pre></div>
<h3 id="writing-math-equations">Writing math equations</h3>
<p>Math equations can be written in LaTeX and enclosed in double dollar signs. The equations are rendered by <a href="https://katex.org/">KaTeX</a>.</p>
<p><span class="math display">$$ \ln x = \int_{-\infty}^x \frac 1 y \, dy  $$</span></p>
<h3 id="decks">Decks</h3>
<p>Decks and presentations are created in a similar fashion to blog files but placed in the <code>decks</code> directory instead. Decks either contain embedded presentation such as Google Slides or marked up and rendered by <a href="https://revealjs.com/">reveal.js</a>. To enable reveal.js in a presentation the <code>reveal</code> key has to be defined. Optionally a <code>theme</code> key controls which theme should be used to render the presentation.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="an">reveal:</span><span class="co"> true</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="an">theme:</span><span class="co"> league</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="an">featureimage:</span><span class="co"> 2014/06/bitcoin.png</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>Rest of the deck</span></code></pre></div>
<h2 id="editing-templates">Editing templates</h2>
<p>Templates are found in the <code>templates</code> directory. The base layout is defined in <code>default.html</code> and its <code>$page.body$</code> variable is replaced by the previous step in the build pipeline. Variables include:</p>
<ul>
<li><code>page.body</code> for the content body</li>
<li><code>page.url</code> for the destination URL of the page</li>
<li><code>page.path</code> for the original filepath of the page</li>
<li><code>page.foo</code> where foo is specified in the metadata</li>
<li><code>page.title</code> for the page title</li>
<li><code>polish(text)</code> to exchange certain words in the text for an emoji</li>
</ul>
<p>Blog lists has a <code>blogs</code> variable which can be iterated over and these additional variables:</p>
<p>-<code>pages.first.number</code> -<code>pages.first.url</code> -<code>pages.next.number</code> -<code>pages.next.url</code> -<code>pages.previous.number</code> -<code>pages.previous.url</code> -<code>pages.last.number</code> -<code>pages.last.url</code> -<code>pages.current.number</code> -<code>pages.count</code></p>
<p>Single blog posts have these additions:</p>
<ul>
<li><code>blog.title</code></li>
<li><code>blog.date</code></li>
<li><code>blog.category</code></li>
<li><code>blog.tags</code></li>
<li><code>blog.image</code></li>
<li><code>blog.next.url</code></li>
<li><code>blog.previous.url</code></li>
<li><code>blog.summary</code></li>
<li><code>blog.reading.time</code></li>
</ul>
<p>Deck lists has a <code>decks</code> variable which is a list field and can be iterated over.</p>
<p>Single decks have a <code>theme</code> variable.</p>
<p>For more information about templates including control flow, conditionals, partials and loops, refer to this <a href="https://jaspervdj.be/hakyll/tutorials/04-compilers.html">tutorial</a>.</p>
<h2 id="compiling-the-website">Compiling the website</h2>
<p>I have created a script transforms the Markdown to HTML using the compiler. Relevant templates from the <code>templates</code> directory are applied in the build pipeline before the final results are stored in the <code>_site</code> directory.</p>
<pre><code>$ ./build</code></pre>
<p>When working on the content itself it is quite convenient to have a HTTP server which watches which files have been saved recently and compiles the website incrementally. There is also a script for that which binds the server to <code>http://localhost:8000</code>.</p>
<pre><code>$ ./watch</code></pre>
    </section>

</article>

        </main>
     
        <footer class="l-footer">
            <p class="p-copyright">
                Copyright <i class="fas fa-heart" style="color: red;"></i> Gísli Kristjánsson 2022
            </p>
        </footer>

        <link rel="stylesheet" href="../katex/katex.min.css">
        <script defer src="../katex/katex.min.js"></script>
        <script type="text/javascript" script defer src="../katex/auto-render.min.js" onload="renderMathInElement(document.body);"></script>
    </body>
</html>
            
